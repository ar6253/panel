<script>
  const params = new URLSearchParams(window.location.search);
  const user = params.get('user') || "کاربر ناشناس";
  console.log("User:", user); // بررسی اینکه نام کاربری درست گرفته می‌شود

  const nameInput = document.getElementById('name');
  const phoneInput = document.getElementById('phone');
  const editionSelect = document.getElementById('edition');
  const saveBtn = document.getElementById('saveBtn');
  const saveMsg = document.getElementById('save-msg');

  // بارگذاری اطلاعات قبلی
  const savedData = JSON.parse(localStorage.getItem(`profile_${user}`));
  if(savedData){
    console.log("Load Data:", savedData); // بررسی داده بارگذاری شده
    nameInput.value = savedData.name || "";
    phoneInput.value = savedData.phone || "";
    editionSelect.value = savedData.edition || "";
  }

  function saveProfile(){
    const name = nameInput.value.trim();
    const phone = phoneInput.value.trim();
    const edition = editionSelect.value;

    if(!name || !phone || !edition){
      alert("لطفاً همه فیلدها را پر کنید");
      return;
    }

    localStorage.setItem(`profile_${user}`, JSON.stringify({name, phone, edition}));
    console.log("Saved Data:", {name, phone, edition}); // بررسی ذخیره
    saveMsg.style.display = "block";
    setTimeout(() => { saveMsg.style.display = "none"; }, 3000);
  }

  saveBtn.addEventListener('click', saveProfile);
</script>
